CREATE DATABASE ORDER_DATABASE

USE ORDER_DATABASE

CREATE TABLE SALESMAN(
    SALESMAN_ID INT,
	NAME VARCHAR(10),
	CITY VARCHAR(10),
	COMMISSION INT,
	PRIMARY KEY(SALESMAN_ID)
	);



SELECT *FROM SALESMAN

CREATE TABLE CUSTOMER(
     CUST_ID INT,
	 CUST_NAME VARCHAR(10),
	 CITY VARCHAR(10),
	 GRADE INT,
	  SALESMAN_ID INT,
	 PRIMARY KEY(CUST_ID),
	 FOREIGN KEY( SALESMAN_ID) REFERENCES SALESMAN(SALESMAN_ID)
 );

 CREATE TABLE ORDERS(
 ORDER_NO INT,
 PURCHASE_AMT INT,
 ORDER_DATE DATE,
 CUST_ID INT,
 SALESMAN_ID INT,
 PRIMARY KEY (ORDER_NO),
 foreign key(CUST_ID) REFERENCES CUSTOMER(CUST_ID),
 FOREIGN KEY(SALESMAN_ID) REFERENCES SALESMAN(SALESMAN_ID)
);
SELECT * FROM SALESMAN

INSERT INTO SALESMAN VALUES(1000,'JOSEPH','MYSORE',13);
INSERT INTO SALESMAN VALUES(1001,'GIRISH','BANGALORE',22);
INSERT INTO SALESMAN VALUES(1002,'MUKUND','MUMBAI',16);
INSERT INTO SALESMAN VALUES(1003,'SURABH','DELHI',19);
INSERT INTO SALESMAN VALUES(1004,'SRINIVAS','HYDRABAD',23);
INSERT INTO SALESMAN VALUES(1005,'MOHAN','RANCHI',13);

SELECT * FROM SALESMAN
UPDATE SALESMAN
SET COMMISSION=23
WHERE SALESMAN_ID=1005;

SELECT * FROM CUSTOMER
INSERT INTO CUSTOMER VALUES(1,'SHARAL','HYDERABAD',40,1004);
INSERT INTO CUSTOMER VALUES(2,'MEENAKSHI','MANGALORE',40,1000);
INSERT INTO CUSTOMER VALUES (3,'VIKKY','MUMBAI',35,1002);
INSERT INTO CUSTOMER VALUES (4, 'JOHN','MUMBAI',20,1002); 
INSERT INTO CUSTOMER VALUES (5, 'GEORGE','BANGALORE',10,1001); 
INSERT INTO CUSTOMER VALUES (6, 'HEVIN','BANGALORE',50,1001); 
INSERT INTO CUSTOMER VALUES (7, 'ROSHAN','DELHI',45,1003);
INSERT INTO CUSTOMER VALUES (8, 'VIMALA','CHENNAI',35,1001); 
INSERT INTO CUSTOMER VALUES (9, 'NAKUL','AYODHYA',15,1005);

INSERT INTO ORDERS VALUES (111, 50000, '04-JAN-17', 1, 1004);
INSERT INTO ORDERS VALUES (222, 45000, '04-JAN-17', 2, 1000);
INSERT INTO ORDERS VALUES (333, 10000, '05-FEB-17', 3, 1002);
INSERT INTO ORDERS VALUES (444, 35000, '13-MAR-17', 4, 1003);
INSERT INTO ORDERS VALUES (555, 75000, '14-MAR-17', 5, 1001);
INSERT INTO ORDERS VALUES (666, 25000, '14-MAR-17', 6, 1004);
INSERT INTO ORDERS VALUES (777, 5000, '27-JUN-17', 7, 1003);
INSERT INTO ORDERS VALUES (888, 52000, '25-AUG-17', 8, 1001);
INSERT INTO ORDERS VALUES (991, 37000, '25-AUG-17', 1, 1004);
INSERT INTO ORDERS VALUES (992, 29000, '09-SEP-17', 2, 1000); 

SELECT * FROM ORDERS

1. . Count the customers with grades above Bangalore�s average

SELECT * FROM CUSTOMER;

 SELECT GRADE,COUNT(DISTINCT CUST_ID)
 FROM CUSTOMER
 GROUP BY GRADE
HAVING GRADE>(SELECT AVG(GRADE)
FROM CUSTOMER
WHERE CITY='BANGALORE');

2. Find the name and numbers of all salesmen who had more than one customer

SELECT SALESMAN_ID,NAME
 FROM SALESMAN
 WHERE SALESMAN_ID IN (SELECT SALESMAN_ID
 FROM CUSTOMER
 GROUP BY SALESMAN_ID
 HAVING COUNT(CUST_ID)>1);

3.List all salesmen names and customer names for whom order amount is more than 4000.

 SELECT NAME,CUST_NAME
 FROM SALESMAN S,CUSTOMER C,ORDERS O
  WHERE S.SALESMAN_ID=O.SALESMAN_ID AND 
O.CUST_ID=C.CUST_ID AND PURCHASE_AMT>4000;


4.   Demonstrate the DELETE operation by removing salesman with id 1000. All his 
orders must also be deleted.

Delete from SALESMAN Where Salesman_Id=1000



1. . Count the customers with grades above Bangalore’s average

SELECT * FROM CUSTOMER;

 SELECT GRADE,COUNT(DISTINCT CUST_ID)
 FROM CUSTOMER
 GROUP BY GRADE
HAVING GRADE>(SELECT AVG(GRADE)
FROM CUSTOMER
WHERE CITY='BANGALORE');

2. Find the name and numbers of all salesmen who had more than one customer

SELECT SALESMAN_ID,NAME
 FROM SALESMAN
 WHERE SALESMAN_ID IN (SELECT SALESMAN_ID
 FROM CUSTOMER
 GROUP BY SALESMAN_ID
 HAVING COUNT(CUST_ID)>1);

3.List all salesmen names and customer names for whom order amount is more than 4000.

 SELECT NAME,CUST_NAME
 FROM SALESMAN S,CUSTOMER C,ORDERS O
  WHERE S.SALESMAN_ID=O.SALESMAN_ID AND 
O.CUST_ID=C.CUST_ID AND PURCHASE_AMT>4000;


4.   Demonstrate the DELETE operation by removing salesman with id 1000. All his 
orders must also be deleted.

Delete from SALESMAN Where Salesman_Id=1000;
